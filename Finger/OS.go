package Finger

import (
	"github.com/lcvvvv/gonmap"
	"time"
)

type OS struct {
}

func (os *OS) Scan(ip string, port int, timeout time.Duration) (string, int, string, string, string) {
	nmap := gonmap.New()
	status, response := nmap.ScanTimeout(ip, port, timeout)
	if status.String() == "Matched" {
		return ip, port, "Open", response.FingerPrint.Service, response.FingerPrint.Version
	} else {
		return ip, port, status.String(), "", ""
	}
}
